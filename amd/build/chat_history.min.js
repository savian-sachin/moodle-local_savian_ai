/**
 * Savian AI Chat History Viewer (Teacher/Admin)
 *
 * @module     local_savian_ai/chat_history
 * @copyright  2025 Savian AI
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_savian_ai/chat_history",["jquery","core/ajax"],(function($,Ajax){var ChatHistory=function(){this.courseId=null};return ChatHistory.prototype.init=function(params){this.courseId=params.courseid,this.render(),this.loadConversations(),this.loadAnalytics()},ChatHistory.prototype.render=function(){$("#chat-history-main").html('\n            <div class="savian-chat-history-viewer">\n                \x3c!-- Analytics Cards --\x3e\n                <div class="row mb-4">\n                    <div class="col-md-3">\n                        <div class="card text-center">\n                            <div class="card-body">\n                                <div class="h2 mb-0 savian-text-primary" id="stat-conversations">-</div>\n                                <div class="text-muted small">Conversations</div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-md-3">\n                        <div class="card text-center">\n                            <div class="card-body">\n                                <div class="h2 mb-0 savian-text-primary" id="stat-messages">-</div>\n                                <div class="text-muted small">Messages</div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-md-3">\n                        <div class="card text-center">\n                            <div class="card-body">\n                                <div class="h2 mb-0 savian-text-primary" id="stat-users">-</div>\n                                <div class="text-muted small">Active Users</div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="col-md-3">\n                        <div class="card text-center">\n                            <div class="card-body">\n                                <div class="h2 mb-0 savian-text-primary" id="stat-feedback">-</div>\n                                <div class="text-muted small">Positive Feedback</div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                \x3c!-- Conversations Table --\x3e\n                <div class="card">\n                    <div class="card-header">\n                        <h4 class="mb-0">Student Conversations</h4>\n                    </div>\n                    <div class="card-body">\n                        <div class="table-responsive">\n                            <table class="table table-striped" id="savian-conversations-table">\n                                <thead>\n                                    <tr>\n                                        <th>Student</th>\n                                        <th>Messages</th>\n                                        <th>Last Active</th>\n                                        <th>Actions</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    <tr>\n                                        <td colspan="4" class="text-center">\n                                            <div class="spinner-border spinner-border-sm"></div>\n                                        </td>\n                                    </tr>\n                                </tbody>\n                            </table>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        ')},ChatHistory.prototype.loadConversations=function(){Ajax.call([{methodname:"local_savian_ai_list_conversations",args:{courseid:this.courseId}}])[0].done((function(response){if(response.success&&response.data){var tbody="";response.data.forEach((function(conv){var lastActive=new Date(1e3*conv.last_message_at).toLocaleString();tbody+="\n                        <tr>\n                            <td>User ".concat(conv.user_id,"</td>\n                            <td>").concat(conv.message_count,"</td>\n                            <td>").concat(lastActive,'</td>\n                            <td>\n                                <button class="btn btn-sm btn-primary savian-view-conversation" data-conversation-id="').concat(conv.id,'">\n                                    <i class="fa fa-eye"></i> View\n                                </button>\n                            </td>\n                        </tr>\n                    ')})),""===tbody&&(tbody='<tr><td colspan="4" class="text-center text-muted">No conversations yet</td></tr>'),$("#savian-conversations-table tbody").html(tbody)}})).fail((function(error){console.error("Failed to load conversations:",error)}))},ChatHistory.prototype.loadAnalytics=function(){$("#stat-conversations").text("0"),$("#stat-messages").text("0"),$("#stat-users").text("0"),$("#stat-feedback").text("0%")},{init:function(params){(new ChatHistory).init(params)}}}));

//# sourceMappingURL=chat_history.min.js.map