/**
 * Savian AI Full-Page Chat Interface
 *
 * @module     local_savian_ai/chat_interface
 * @copyright  2025 Savian AI
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_savian_ai/chat_interface",["jquery","core/ajax"],(function($,Ajax){var ChatInterface=function(){this.conversationId=null,this.courseId=null};return ChatInterface.prototype.init=function(params){this.courseId=params.courseid||null,this.conversationId=params.conversationid||null,this.fullpage=params.fullpage||!1,this.render(),this.attachEvents(),this.conversationId&&this.loadConversation(this.conversationId)},ChatInterface.prototype.render=function(){$("#savian-chat-main").html('\n            <div class="savian-chat-fullpage">\n                <div class="savian-chat-sidebar">\n                    <div class="savian-sidebar-header">\n                        <h4>Conversations</h4>\n                        <button class="btn btn-sm btn-savian" id="new-conversation-btn">\n                            <i class="fa fa-plus"></i> New\n                        </button>\n                    </div>\n                    <div class="savian-conversation-list" id="savian-conversation-list">\n                        <div class="text-center p-3">\n                            <div class="spinner-border spinner-border-sm"></div>\n                        </div>\n                    </div>\n                </div>\n\n                <div class="savian-chat-main">\n                    <div class="savian-chat-messages-container" id="chat-messages-full">\n                        <div class="savian-chat-message assistant">\n                            <div class="savian-message-content">\n                                Hi! I\'m your AI assistant. Select a conversation or start a new one.\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class="savian-chat-input-area">\n                        <textarea\n                            id="chat-input-full"\n                            class="form-control"\n                            placeholder="Type your message..."\n                            rows="3"\n                        ></textarea>\n                        <button id="send-message-btn" class="btn btn-savian mt-2">\n                            <i class="fa fa-paper-plane"></i> Send\n                        </button>\n                    </div>\n                </div>\n            </div>\n        '),this.loadConversationList()},ChatInterface.prototype.attachEvents=function(){var self=this;$("#send-message-btn").on("click",(function(){self.sendMessage()})),$("#chat-input-full").on("keydown",(function(e){"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),self.sendMessage())})),$("#new-conversation-btn").on("click",(function(){self.startNewConversation()})),$(document).on("click",".savian-conversation-item",(function(){var convId=parseInt($(this).data("conversation-id"));self.loadConversation(convId),$(".savian-conversation-item").removeClass("active"),$(this).addClass("active")}))},ChatInterface.prototype.loadConversationList=function(){Ajax.call([{methodname:"local_savian_ai_list_conversations",args:{courseid:this.courseId||0}}])[0].done((function(response){if(response.success&&response.data){var html="";Array.isArray(response.data)&&response.data.length>0&&response.data.forEach((function(conv){var title=conv.title||"Conversation "+conv.id,time=new Date(1e3*conv.last_message_at).toLocaleString();html+='\n                            <div class="savian-conversation-item" data-conversation-id="'.concat(conv.id,'">\n                                <div class="savian-conv-title">').concat(title,'</div>\n                                <div class="savian-conv-meta">\n                                    <small>').concat(conv.message_count," messages â€¢ ").concat(time,"</small>\n                                </div>\n                            </div>\n                        ")}));$("#savian-conversation-list").html(html||'<p class="text-muted p-3">No conversations yet. Start chatting below!</p>')}else console.error("Invalid response:",response),$("#savian-conversation-list").html('<p class="text-muted p-3">No conversations yet</p>')})).fail((function(error){console.error("Failed to load conversations:",error),$("#savian-conversation-list").html('<p class="text-danger p-3">Failed to load. Check console for details.</p>')}))},ChatInterface.prototype.loadConversation=function(conversationId){this.conversationId=conversationId},ChatInterface.prototype.sendMessage=function(){$("#chat-input-full").val().trim()},ChatInterface.prototype.startNewConversation=function(){this.conversationId=null;$("#chat-messages-full").html('<div class="savian-chat-message assistant"><div class="savian-message-content">Hi! I\'m your AI tutor. How can I help you today?</div></div>'),$(".savian-conversation-item").removeClass("active")},{init:function(params){(new ChatInterface).init(params)}}}));

//# sourceMappingURL=chat_interface.min.js.map